<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PORTAL ENIGMA FALLS</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <style>
        :root { 
            --primary: #ff4757; 
            --secondary: #2ed573; 
            --accent: #1e90ff;
            --bg: #f1f2f6;
        }

        body { font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background: var(--bg); margin: 0; color: #2f3542; }

        /* CAPA INICIAL ALEGRE */
        #capa { 
            height: 100vh; 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            text-align: center; 
            background: linear-gradient(135deg, #74ebd5 0%, #9face6 100%);
            padding: 20px;
        }

        .logo-capa { 
            max-width: 320px; 
            filter: drop-shadow(0 10px 15px rgba(0,0,0,0.1));
            margin-bottom: 20px;
            animation: bounce 3s infinite ease-in-out;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .welcome-text {
            color: #fff;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }

        .botoes { display: flex; gap: 15px; flex-wrap: wrap; justify-content: center; }

        .btn { 
            padding: 15px 35px; 
            border: none; 
            border-radius: 50px;
            background: #fff; 
            color: #57606f; 
            cursor: pointer; 
            text-transform: uppercase; 
            letter-spacing: 1px; 
            transition: 0.3s; 
            font-weight: 800; 
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
        }

        .btn:hover { transform: scale(1.05); box-shadow: 0 12px 20px rgba(0,0,0,0.2); color: var(--accent); }
        .btn-redacao { background: var(--primary); color: #fff; }
        .btn-redacao:hover { background: #ff6b81; color: #fff; }

        /* TELAS INTERNAS */
        .tela { display: none; min-height: 100vh; background: #fff; padding: 20px; box-sizing: border-box; }
        
        .nav-interna { 
            max-width: 1000px; 
            margin: 0 auto 30px auto; 
            background: #fff;
            padding: 15px 25px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }

        /* FEED DE NOT√çCIAS COLORIDO */
        .feed { max-width: 800px; margin: 0 auto; }
        .post { 
            background: #fff;
            border-radius: 20px;
            padding: 25px; 
            margin-bottom: 30px; 
            position: relative; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            border-top: 8px solid var(--accent);
        }
        
        .post:nth-child(even) { border-top-color: var(--secondary); }
        .post:nth-child(3n) { border-top-color: var(--primary); }

        .post h2 { font-size: 28px; color: #2f3542; margin: 10px 0; line-height: 1.2; }
        .post img { width: 100%; border-radius: 15px; margin: 15px 0; }
        .post-meta { font-size: 12px; color: #a4b0be; font-weight: bold; }
        .post-body { font-size: 17px; line-height: 1.6; color: #57606f; text-align: left; }

        /* FORMUL√ÅRIO */
        .form-box { max-width: 500px; margin: 0 auto; padding: 20px; background: #f9f9f9; border-radius: 20px; }
        input, textarea { 
            width: 100%; padding: 15px; margin-bottom: 15px; border-radius: 10px;
            border: 2px solid #eee; font-size: 16px; box-sizing: border-box; 
        }
        input:focus { border-color: var(--accent); outline: none; }
        
        .upload-area { 
            display: block; border: 2px dashed #ccc; padding: 20px; 
            text-align: center; margin-bottom: 15px; cursor: pointer; 
            border-radius: 10px; background: #fff; 
        }

        .btn-postar { 
            background: linear-gradient(to right, var(--accent), var(--secondary)); 
            color: #fff; border: none; width: 100%; padding: 18px; 
            cursor: pointer; font-weight: bold; border-radius: 10px; font-size: 16px;
        }

        .btn-del { position: absolute; top: 15px; right: 15px; background: #fff2f2; border: none; color: #ff4757; border-radius: 50%; width: 30px; height: 30px; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>

    <div id="capa">
        <img src="foto.png" class="logo-capa" alt="PORTAL ENIGMA FALLS">
        <div class="welcome-text">Bem-vindo ao Portal de Not√≠cias!</div>
        <div class="botoes">
            <button class="btn" onclick="mudarTela('tela-visualizar'); carregar();">Ver Novidades</button>
            <button class="btn btn-redacao" onclick="abrirRedacao()">Painel de Reda√ß√£o</button>
        </div>
    </div>

    <div id="tela-visualizar" class="tela">
        <div class="nav-interna">
            <img src="foto.png" style="height: 40px;">
            <button onclick="mudarTela('capa')" class="btn" style="padding: 10px 20px; font-size: 12px;">Voltar</button>
        </div>
        <div id="feed" class="feed"></div>
    </div>

    <div id="tela-gerar" class="tela">
        <div class="nav-interna"><h2>Criar Publica√ß√£o</h2> <button onclick="mudarTela('capa')" style="border:none; background:none; font-size:20px; cursor:pointer;">‚úï</button></div>
        <div class="form-box">
            <input type="text" id="tit" placeholder="D√™ um t√≠tulo legal!">
            <input type="text" id="art" placeholder="Quem participou?">
            <textarea id="fat" rows="5" placeholder="Conte a hist√≥ria aqui..."></textarea>
            
            <label class="upload-area">
                <strong>üì∏ Adicionar Foto</strong>
                <input type="file" id="input-foto" accept="image/*" style="display: none;" onchange="previewImagem(this)">
                <div id="preview-msg" style="font-size: 12px; margin-top: 5px; color: var(--secondary); display: none;">Pronto para postar!</div>
            </label>

            <button class="btn-postar" id="btn-publicar" onclick="publicar()">üöÄ POSTAR NO PORTAL</button>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBtQZwmY-PG9SVlFueM0o2n4Mj0ebVQwTY",
            authDomain: "portal-enigma-falls.firebaseapp.com",
            projectId: "portal-enigma-falls",
            databaseURL: "https://portal-enigma-falls-default-rtdb.firebaseio.com",
            storageBucket: "portal-enigma-falls.firebasestorage.app"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const SENHA = "777";
        let imagemBase64 = "";

        function mudarTela(id) {
            document.querySelectorAll('.tela, #capa').forEach(t => t.style.display = 'none');
            document.getElementById(id).style.display = (id === 'capa') ? 'flex' : 'block';
        }

        function abrirRedacao() {
            if(prompt("SENHA DE ACESSO:") === SENHA) mudarTela('tela-gerar');
        }

        function previewImagem(input) {
            const reader = new FileReader();
            reader.onload = function(e) {
                imagemBase64 = e.target.result;
                document.getElementById('preview-msg').style.display = 'block';
            }
            reader.readAsDataURL(input.files[0]);
        }

        function publicar() {
            const t = document.getElementById('tit').value;
            const a = document.getElementById('art').value;
            const f = document.getElementById('fat').value;
            const btn = document.getElementById('btn-publicar');

            if(!t || !f) return alert("Ei! Coloque um t√≠tulo e a hist√≥ria.");

            btn.disabled = true;
            btn.innerText = "POSTANDO...";

            let base = `O Portal Enigma Falls traz uma novidade incr√≠vel sobre ${a}! üéâ ${f}. `;
            let complemento = "Estamos todos muito animados com essa not√≠cia e vamos continuar acompanhando tudo de perto para contar para voc√™s. Fiquem ligados aqui no portal para n√£o perderem nenhum detalhe desse servidor maravilhoso!";
            let textoFinal = base + (f.length < 80 ? complemento : "");

            db.ref('noticias').push({
                titulo: t, texto: textoFinal, imagem: imagemBase64, data: new Date().toLocaleString('pt-BR')
            }).then(() => {
                alert("SUCESSO! Sua not√≠cia j√° est√° no ar.");
                imagemBase64 = "";
                document.getElementById('tit').value = "";
                document.getElementById('fat').value = "";
                document.getElementById('preview-msg').style.display = 'none';
                btn.disabled = false;
                btn.innerText = "üöÄ POSTAR NO PORTAL";
                mudarTela('tela-visualizar');
                carregar();
            });
        }

        function apagar(id) {
            if(prompt("SENHA PARA APAGAR:") === SENHA) db.ref('noticias/' + id).remove();
        }

        function carregar() {
            db.ref('noticias').on('value', snapshot => {
                const feed = document.getElementById('feed');
                feed.innerHTML = "";
                let lista = [];
                snapshot.forEach(d => { let n = d.val(); n.id = d.key; lista.unshift(n); });
                
                feed.innerHTML = lista.map(n => `
                    <div class="post">
                        <button class="btn-del" onclick="apagar('${n.id}')">‚úï</button>
                        <span class="post-meta">üóìÔ∏è ${n.data}</span>
                        <h2>${n.titulo}</h2>
                        ${n.imagem ? `<img src="${n.imagem}">` : ''}
                        <div class="post-body">${n.texto}</div>
                    </div>
                `).join('');
            });
        }
    </script>
</body>
</html>
