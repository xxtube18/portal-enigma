<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PORTAL ENIGMA FALLS</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <style>
        :root { --red: #bc0000; --dark: #000; --paper: #ffffff; }
        body { font-family: 'Times New Roman', serif; background: var(--dark); margin: 0; color: #fff; }

        /* CAPA INICIAL */
        #capa { height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; background: radial-gradient(circle, #1a1a1a, #000); }
        .logo-capa { max-width: 400px; margin-bottom: 30px; }
        .botoes { display: flex; gap: 20px; }
        .btn { padding: 15px 40px; border: 1px solid #fff; background: none; color: #fff; cursor: pointer; text-transform: uppercase; letter-spacing: 2px; transition: 0.4s; font-weight: bold; }
        .btn:hover { background: #fff; color: #000; }
        .btn-redacao { border-color: var(--red); color: var(--red); }
        .btn-redacao:hover { background: var(--red); color: #fff; }

        /* TELAS */
        .tela { display: none; min-height: 100vh; background: var(--paper); color: #000; padding: 20px; box-sizing: border-box; }
        .nav-interna { max-width: 1000px; margin: 0 auto 20px auto; border-bottom: 4px solid #000; padding: 10px 0; display: flex; justify-content: space-between; align-items: center; }
        
        /* LAYOUT DOS POSTS (ESTILO JORNAL) */
        .feed { max-width: 900px; margin: 0 auto; }
        .post { border-bottom: 2px solid #000; padding: 40px 0; position: relative; }
        .post-header { text-align: center; margin-bottom: 20px; }
        .post h2 { font-size: 45px; margin: 0; text-transform: uppercase; line-height: 0.9; font-weight: 900; }
        .post img { width: 100%; max-height: 500px; object-fit: cover; margin: 20px 0; border: 1px solid #ddd; }
        .post-meta { font-family: Arial, sans-serif; font-size: 12px; text-transform: uppercase; color: var(--red); font-weight: bold; margin-bottom: 10px; display: block;}
        .post-body { font-size: 21px; line-height: 1.5; text-align: justify; columns: 2; column-gap: 40px; }
        
        @media (max-width: 700px) { .post-body { columns: 1; } .post h2 { font-size: 30px; } }

        /* FORMULÁRIO */
        .form-box { max-width: 600px; margin: 0 auto; padding: 20px; }
        input, textarea { width: 100%; padding: 15px; margin-bottom: 15px; border: 1px solid #000; font-size: 16px; font-family: Arial; }
        .btn-postar { background: var(--red); color: #fff; border: none; width: 100%; padding: 20px; cursor: pointer; font-weight: bold; font-size: 18px; }

        .btn-del { position: absolute; top: 10px; right: 0; background: none; border: none; color: #ccc; cursor: pointer; }
    </style>
</head>
<body>

    <div id="capa">
        <img src="foto.png" class="logo-capa" alt="PORTAL ENIGMA FALLS">
        <div class="botoes">
            <button class="btn" onclick="mudarTela('tela-visualizar'); carregar();">Visualizar Notícias</button>
            <button class="btn btn-redacao" onclick="abrirRedacao()">Gerar Notícia</button>
        </div>
    </div>

    <div id="tela-visualizar" class="tela">
        <div class="nav-interna">
            <img src="foto.png" style="height: 50px;">
            <button onclick="mudarTela('capa')" style="background:#000; color:#fff; border:none; padding:10px 20px; cursor:pointer;">VOLTAR AO INÍCIO</button>
        </div>
        <div id="feed" class="feed"></div>
    </div>

    <div id="tela-gerar" class="tela">
        <div class="nav-interna"><h2>NOVA REDAÇÃO</h2> <button onclick="mudarTela('capa')">X</button></div>
        <div class="form-box">
            <input type="text" id="tit" placeholder="MANCHETE PRINCIPAL">
            <input type="text" id="art" placeholder="QUEM É O ENVOLVIDO?">
            <textarea id="fat" rows="8" placeholder="O QUE ACONTECEU? (Pode escrever pouco, o sistema completa)"></textarea>
            <input type="text" id="img" placeholder="LINK DA FOTO (.JPG / .PNG)">
            <button class="btn-postar" onclick="publicar()">PUBLICAR AGORA</button>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBtQZwmY-PG9SVlFueM0o2n4Mj0ebVQwTY",
            authDomain: "portal-enigma-falls.firebaseapp.com",
            projectId: "portal-enigma-falls",
            databaseURL: "https://portal-enigma-falls-default-rtdb.firebaseio.com",
            storageBucket: "portal-enigma-falls.firebasestorage.app"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const SENHA = "777";

        function mudarTela(id) {
            document.querySelectorAll('.tela, #capa').forEach(t => t.style.display = 'none');
            document.getElementById(id).style.display = (id === 'capa') ? 'flex' : 'block';
        }

        function abrirRedacao() {
            if(prompt("SENHA DO REDATOR:") === SENHA) mudarTela('tela-gerar');
        }

        function publicar() {
            const t = document.getElementById('tit').value;
            const a = document.getElementById('art').value;
            const f = document.getElementById('fat').value;
            const i = document.getElementById('img').value;

            if(!t || !f) return alert("Preencha a manchete!");

            // LÓGICA DE EXPANSÃO DE TEXTO (IA SIMULADA)
            let base = `Em um desdobramento inesperado que pegou a todos de surpresa, o Portal Enigma Falls confirmou informações exclusivas sobre ${a}. De acordo com as investigações preliminares conduzidas por nossa equipe, os fatos indicam que ${f}. `;
            
            let complemento = "Fontes ligadas aos envolvidos preferiram manter o anonimato, mas garantiram que novas atualizações devem surgir nas próximas horas. A redação do Enigma Falls segue em plantão contínuo, monitorando cada movimento deste caso para trazer a verdade aos nossos leitores em primeira mão. Até o fechamento desta edição, nenhum pronunciamento oficial adicional foi emitido, deixando o cenário ainda mais envolto em mistério e expectativa.";

            let textoFinal = base + (f.length < 150 ? complemento : "");

            db.ref('noticias').push({
                titulo: t, texto: textoFinal, imagem: i, data: new Date().toLocaleString('pt-BR')
            }).then(() => {
                alert("MANCHETE PUBLICADA!");
                mudarTela('tela-visualizar');
                carregar();
            });
        }

        function apagar(id) {
            if(prompt("SENHA PARA APAGAR:") === SENHA) db.ref('noticias/' + id).remove();
        }

        function carregar() {
            db.ref('noticias').on('value', snapshot => {
                const feed = document.getElementById('feed');
                feed.innerHTML = "";
                let lista = [];
                snapshot.forEach(d => { let n = d.val(); n.id = d.key; lista.unshift(n); });
                
                feed.innerHTML = lista.map(n => `
                    <div class="post">
                        <button class="btn-del" onclick="apagar('${n.id}')">Excluir</button>
                        <span class="post-meta">URGENTE • ${n.data}</span>
                        <div class="post-header"><h2>${n.titulo}</h2></div>
                        ${n.imagem ? `<img src="${n.imagem}">` : ''}
                        <div class="post-body">${n.texto}</div>
                    </div>
                `).join('');
            });
        }
    </script>
</body>
</html>
